import{ce as g,bd as q}from"./main-B6snbbeR.js";import{a as E,w as S}from"./index-CvOPxmL5.js";class R extends Error{constructor(t,s){super(t,s),this.name="FetchError",s?.cause&&!this.cause&&(this.cause=s.cause)}}function A(o){const t=o.error?.message||o.error?.toString()||"",s=o.request?.method||o.options?.method||"GET",p=o.request?.url||String(o.request)||"/",f=`[${s}] ${JSON.stringify(p)}`,i=o.response?`${o.response.status} ${o.response.statusText}`:"<no response>",u=`${f}: ${i}${t?` ${t}`:""}`,r=new R(u,o.error?{cause:o.error}:void 0);for(const n of["request","options","response"])Object.defineProperty(r,n,{get(){return o[n]}});for(const[n,c]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(r,n,{get(){return o.response&&o.response[c]}});return r}const $=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function b(o="GET"){return $.has(o.toUpperCase())}function j(o){if(o===void 0)return!1;const t=typeof o;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(o)?!0:o.buffer||o instanceof FormData||o instanceof URLSearchParams?!1:o.constructor&&o.constructor.name==="Object"||typeof o.toJSON=="function"}const C=new Set(["image/svg","application/xml","application/xhtml","application/html"]),P=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function k(o=""){if(!o)return"json";const t=o.split(";").shift()||"";return P.test(t)?"json":t==="text/event-stream"?"stream":C.has(t)||t.startsWith("text/")?"text":"blob"}function U(o,t,s,p){const f=D(t?.headers??o?.headers,s?.headers,p);let i;return(s?.query||s?.params||t?.params||t?.query)&&(i={...s?.params,...s?.query,...t?.params,...t?.query}),{...s,...t,query:i,params:i,headers:f}}function D(o,t,s){if(!t)return new s(o);const p=new s(t);if(o)for(const[f,i]of Symbol.iterator in o||Array.isArray(o)?o:new s(o))p.set(f,i);return p}async function l(o,t){if(t)if(Array.isArray(t))for(const s of t)await s(o);else await t(o)}const F=new Set([408,409,425,429,500,502,503,504]),O=new Set([101,204,205,304]);function w(o={}){const{fetch:t=globalThis.fetch,Headers:s=globalThis.Headers,AbortController:p=globalThis.AbortController}=o;async function f(r){const n=r.error&&r.error.name==="AbortError"&&!r.options.timeout||!1;if(r.options.retry!==!1&&!n){let e;typeof r.options.retry=="number"?e=r.options.retry:e=b(r.options.method)?0:1;const d=r.response&&r.response.status||500;if(e>0&&(Array.isArray(r.options.retryStatusCodes)?r.options.retryStatusCodes.includes(d):F.has(d))){const m=typeof r.options.retryDelay=="function"?r.options.retryDelay(r):r.options.retryDelay||0;return m>0&&await new Promise(a=>setTimeout(a,m)),i(r.request,{...r.options,retry:e-1})}}const c=A(r);throw Error.captureStackTrace&&Error.captureStackTrace(c,i),c}const i=async function(n,c={}){const e={request:n,options:U(n,c,o.defaults,s),response:void 0,error:void 0};if(e.options.method&&(e.options.method=e.options.method.toUpperCase()),e.options.onRequest&&await l(e,e.options.onRequest),typeof e.request=="string"&&(e.options.baseURL&&(e.request=E(e.request,e.options.baseURL)),e.options.query&&(e.request=S(e.request,e.options.query),delete e.options.query),"query"in e.options&&delete e.options.query,"params"in e.options&&delete e.options.params),e.options.body&&b(e.options.method))if(j(e.options.body)){const a=e.options.headers.get("content-type");typeof e.options.body!="string"&&(e.options.body=a==="application/x-www-form-urlencoded"?new URLSearchParams(e.options.body).toString():JSON.stringify(e.options.body)),e.options.headers=new s(e.options.headers||{}),a||e.options.headers.set("content-type","application/json"),e.options.headers.has("accept")||e.options.headers.set("accept","application/json")}else("pipeTo"in e.options.body&&typeof e.options.body.pipeTo=="function"||typeof e.options.body.pipe=="function")&&("duplex"in e.options||(e.options.duplex="half"));let d;if(!e.options.signal&&e.options.timeout){const a=new p;d=setTimeout(()=>{const y=new Error("[TimeoutError]: The operation was aborted due to timeout");y.name="TimeoutError",y.code=23,a.abort(y)},e.options.timeout),e.options.signal=a.signal}try{e.response=await t(e.request,e.options)}catch(a){return e.error=a,e.options.onRequestError&&await l(e,e.options.onRequestError),await f(e)}finally{d&&clearTimeout(d)}if((e.response.body||e.response._bodyInit)&&!O.has(e.response.status)&&e.options.method!=="HEAD"){const a=(e.options.parseResponse?"json":e.options.responseType)||k(e.response.headers.get("content-type")||"");switch(a){case"json":{const y=await e.response.text(),T=e.options.parseResponse||g;e.response._data=T(y);break}case"stream":{e.response._data=e.response.body||e.response._bodyInit;break}default:e.response._data=await e.response[a]()}}return e.options.onResponse&&await l(e,e.options.onResponse),!e.options.ignoreResponseError&&e.response.status>=400&&e.response.status<600?(e.options.onResponseError&&await l(e,e.options.onResponseError),await f(e)):e.response},u=async function(n,c){return(await i(n,c))._data};return u.raw=i,u.native=(...r)=>t(...r),u.create=(r={},n={})=>w({...o,...n,defaults:{...o.defaults,...n.defaults,...r}}),u}const h=(function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")})(),_=h.fetch?(...o)=>h.fetch(...o):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),H=h.Headers,L=h.AbortController,B=w({fetch:_,Headers:H,AbortController:L}),M=B.create({baseURL:"/api",async onRequest({options:o}){const t=q("accessToken").value;t&&o.headers.append("Authorization",`Bearer ${t}`)}});export{M as $};
